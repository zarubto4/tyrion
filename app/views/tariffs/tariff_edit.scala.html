@import models.project.global.financial.{Model_GeneralTariffLabel, Model_GeneralTariffExtensions, Model_GeneralTariff}

@(tariff: Model_GeneralTariff)

<section class="content-header">
    <h1> General Tariffs - @tariff.tariff_name </h1>
    <ol class="breadcrumb">
        <li><a href="@routes.Controller_Dashboard.index()"><i class="fa fa-globe"></i> Dashboard </a></li>
        <li class="active"><i class="fa fa-share"></i> General Tariffs for users </li>
        <li class="active"><i class="fa fa-wrench"></i> @tariff.tariff_name </li>
    </ol>
</section>

@*/*/*  General Tariff -----------------------------------------------------------------------------------------  */*/*@

<section class="content">

    <div class="row">
        <div class="col-md-12">
            <div class="box">
                <div class="box-header with-border">
                    <h3 class="box-title">General Tariff information</h3>
                    <div class="pull-right">
                        <div class="btn-group">
                        </div><!-- /.btn-group -->
                    </div><!-- /.pull-right -->
                </div>
                <div class="box-body">
                    <form id="tariff_main_form">

                        <div class="form-group">
                            <label class="col-sm-2 control-label">Tariff Id</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="general_tariff_id" value="@tariff.id"  name="id" readonly>
                            </div>
                        </div><br>


                        <div class="form-group">
                            <label for="tariff_main_form" class="col-sm-2 control-label">Tarif name</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="tariff_name" value="@tariff.tariff_name"  name="tariff_name">
                            </div>
                        </div><br>

                        <div class="form-group">
                            <label for="tariff_main_form" class="col-sm-2 control-label">Tariff description</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="tariff_description" value="@tariff.tariff_description"  name="tariff_description">
                            </div>
                        </div><br>

                        <div class="form-group">
                            <label for="tariff_main_form" class="col-sm-2 control-label">Identificator</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="identificator" value="@tariff.identificator"  name="identificator">
                            </div>
                        </div><br><br>

                        <div class="form-group">

                            <label for="tariff_main_form" class="col-sm-2 control-label">Color (<a href="http://keenthemes.com/preview/metronic/theme/admin_4/ui_colors.html">Výběr barev zde</a>)</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="tariff_name" value="@tariff.color"  name="color">
                            </div>

                        </div>

                        <br><br>

                        <div class="form-group">
                            <label for="tariff_main_form" class="col-sm-2 control-label">Number of free months</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="tariff_name" value="@tariff.number_of_free_months"  name="number_of_free_months">
                            </div>
                        </div><br><br>

                        <div class="form-group">
                            <label for="tariff_main_form" class="col-sm-2 control-label">Price in CZK</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="tariff_name" value="@tariff.czk"  name="czk">
                            </div>
                        </div><br>

                        <div class="form-group">
                            <label for="tariff_main_form" class="col-sm-2 control-label">Price in EUR</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="tariff_name" value="@tariff.eur"  name="eur">
                            </div>
                        </div><br>

                        <div class="form-group">
                            <label for="tariff_main_form" class="col-sm-2 control-label">Price in USD</label>

                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="tariff_name" value="@tariff.usd"  name="usd">
                            </div>
                        </div><br><br>

                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <div class="checkbox"><label> @if( tariff.company_details_required ){ <input type="checkbox" name="company_details_required" checked>}else{<input type="checkbox" name="company_details_required">}
                                    Company detaily required
                                    </label>
                                </div>
                            </div>
                        </div><br>

                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <div class="checkbox"><label> @if( tariff.required_payment_mode ){ <input type="checkbox" name="required_payment_mode" checked>}else{<input type="checkbox" name="required_payment_mode" >}
                                    Payment mode required ( Vyžaduji aby uživatel vybral v jakém modu bude platit)
                                </label>
                                </div>
                            </div>
                        </div>

                                <div class="form-group">
                                    <div class="col-sm-offset-3 col-sm-9">
                                        <div class="checkbox"><label> @if( tariff.mode_annually ){ <input type="checkbox" name="mode_annually" checked>}else{<input type="checkbox" name="mode_annually">}
                                           Měsíčně (Automatické strhávání)
                                        </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-sm-offset-3 col-sm-9">
                                        <div class="checkbox"><label> @if( tariff.mode_credit ){ <input type="checkbox" name="mode_credit" checked>}else{<input type="checkbox" name="mode_credit">}
                                            Přednabytí kreditů
                                        </label>
                                        </div>
                                    </div>
                                </div>

                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <div class="checkbox"><label> @if( tariff.required_payment_method ){ <input type="checkbox" name="required_payment_method" checked>}else{<input type="checkbox" name="required_payment_method">}
                                    Payment method required (Vyžaduji aby si uživatel vybral jakou formou bude platit)
                                </label>
                                </div>
                            </div>
                        </div>

                                <div class="form-group">
                                    <div class="col-sm-offset-3 col-sm-9">
                                        <div class="checkbox"><label> @if( tariff.bank_transfer_support ){ <input type="checkbox" name="bank_transfer_support" checked>}else{<input type="checkbox" name="bank_transfer_support">}
                                            Bankovním převodem
                                        </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-sm-offset-3 col-sm-9">
                                        <div class="checkbox"><label> @if( tariff.credit_card_support ){ <input type="checkbox" name="credit_card_support" checked>}else{<input type="checkbox" name="credit_card_support">}
                                            Mužu platit kartou
                                        </label>
                                        </div>
                                    </div>
                                </div>


                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <div class="checkbox"><label> @if( tariff.free_tariff ){ <input type="checkbox" name="free_tariff" checked>}else{<input type="checkbox" name="free_tariff">}
                                    Free Tariff
                                </label>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="box-footer">
                    <button id="createCompilationServerButton" value="" class="btn btn-primary" type="button" onclick="updateGeneralTariff()">Save changes</button>
                </div>
            </div>
        </div>
    </div>


    <div class="row">
        <div class="col-md-12">
            <div class="box">
                <div class="box-header with-border">
                    <h3 class="box-title">Tarifs Labes</h3>
                    <div class="pull-right">
                        <div class="btn-group">
                            <td><button class="btn btn-block btn-info" type="button" onclick="openNewGeneralTariffLabelModal(@tariff.id)">Add New Label</button></td>
                        </div><!-- /.btn-group -->
                    </div><!-- /.pull-right -->
                </div>
                <div class="box-body">
                    <table id="allGeneralsTariffsLabel" class="table table-bordered">
                        <tr>
                            <th>ID</th>
                            <th>Order</th>
                            <th>Label</th>
                            <th>Description (Po najetí myškou)</th>
                            <th>Icon</th>
                            <th>Icon</th>
                            <th>Up</th>
                            <th>Down</th>
                            <th>E</th>
                            <th>X</th>
                        </tr>

                        @for(label <- tariff.labels){
                            <tr>
                                <td>@label.id</td>
                                <td>@label.order_position</td>
                                <td>@label.label</td>
                                <td>@label.description</td>
                                <td><i class="fa fa-fw @label.icon"></i></td>
                                <td>@label.icon</td>
                                <td>@if(label.order_position != 1){<button class="btn btn-block btn-success" type="button" onclick="upGeneralTariffLabel('@label.id')">Up</button>}</td>
                                <td>@if(tariff.labels.length != label.order_position){<button class="btn btn-block btn-warning" type="button" onclick="downGeneralTariffLabel('@label.id')">Down</button>}</td>
                                <td><button class="btn btn-block btn-info" type="button" onclick="openEditGeneralTariffLabelModal('@label.id', '@label.label', '@label.description', '@label.icon')">E</button></td>
                                <td><button class="btn btn-block btn-danger" type="button" onclick="removeGeneralTariffLabel(@label.id)">X</button></td>
                            </tr>
                        }

                    </table>
                </div>
                <div class="box-footer">
                </div>
            </div>
        </div>
    </div>

</section>


<section class="content">

    <div class="row">
        <div class="col-md-12">
            <div class="box">
                <div class="box-header with-border">
                    <h3 class="box-title">External Servicess</h3>
                    <div class="pull-right">
                        <div class="btn-group">
                            <td><button class="btn btn-block btn-info" type="button" onclick="openNewGeneralTariffExtensionModal(@tariff.id)">Create new Servicess</button></td>
                        </div>
                    </div>
                </div>
                <div class="box-body">
                    <table id="allGeneralsTariffsExtensions" class="table table-bordered">
                        <tr>
                            <th>ID</th>
                            <th>Order</th>
                            <th>Name</th>
                            <th>Color</th>
                            <th>Description (Po najetí myškou)</th>
                            <th>Up</th>
                            <th>Down</th>
                            <th>EDIT</th>
                            <th>DEACTIVATE</th>
                        </tr>

                        @for(extension <- tariff.extensions){
                            <tr>
                                <td>@extension.id</td>
                                <td>@extension.order_position</td>
                                <td>@extension.name</td>
                                <td>@extension.color</td>
                                <td>@extension.description</td>

                                <td>@if(extension.order_position != 1){<button class="btn btn-block btn-success" type="button" onclick="upGeneralTariffExtension('@extension.id')">Up</button>}</td>
                                <td>@if(tariff.extensions.length != extension.order_position){<button class="btn btn-block btn-warning" type="button" onclick="downGeneralTariffExtension('@extension.id')">Down</button>}</td>

                                <td><a href='@routes.Controller_Dashboard.general_tariff_extension_edit(tariff.id)'><button class="btn btn-block btn-info" type="button">Settings</button></a></td>
                                <td>
                                    @if(!extension.active) {
                                        <button class="btn btn-block btn-danger" type="button" onclick="activateGeneralTariffExtension(@extension.id)">Deactivate</button>
                                    }else{
                                        <button class="btn btn-block btn-success" type="button" onclick="deactivateGeneralTariffExtension(@extension.id)">Activate</button>
                                    }
                                </td>
                            </tr>
                        }
                    </table>
                </div>
                <div class="box-footer">
                </div>
            </div>
        </div>
    </div>
</section>

@*/*/*  ---------------------------------------------------------------------------------------------   */*/*@

    <div id="newGeneralTariffLabelModal" style="display: none;" class="modal">
        <div style="" class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Create New Label</h4>
                </div>
                <div class="modal-body">
                    <form id="newGeneralTariffLabelForm">

                        <label style="">Tariff Id:</label>
                        <input type="text" class="form-control" id="newGeneralTariffLabelModal_id" value="@tariff.id" name="id" readonly>

                        <label style="">Label:</label>
                        <input type="text" class="form-control" id="label"  name="label">

                        <label ass="control-label">Description:</label>
                        <input type="text" class="form-control" id="desription"  name="description"><br>


                        <label class="control-label">Icon Code: (<a href="http://keenthemes.com/preview/metronic/theme/admin_4/ui_icons.html">Výběr barev zde</a>) </label>
                        <input type="text" class="form-control" placeholder="Font icon" id="label"  name="icon">

                    </form>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-default pull-left" type="button" data-dismiss="modal" onclick="$('#newGeneralTariffLabelModal').css('display','none')">Close</button>
                    <button id="newGeneralTariffButton" value="" class="btn btn-primary" type="button" onclick="newGeneralTariffLabel()">Create New Label</button>
                </div>
            </div>
        </div>
    </div>

    <div id="editGeneralTariffLabelModal" style="display: none;" class="modal">
        <div style="" class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Edit Label</h4>
                </div>
                <div class="modal-body">
                    <form id="editGeneralTariffLabelForm">

                        <label style="">Label Id:</label>
                        <input type="text" class="form-control" id="editGeneralTariffLabelModal_id"  name="id" readonly>

                        <label style="">Label:</label>
                        <input type="text" class="form-control" id="editGeneralTariffLabelModal_label"  name="label">

                        <label ass="control-label">Description:</label>
                        <input type="text" class="form-control" id="editGeneralTariffLabelModal_description"  name="description">

                        <label class="control-label">Icon Code: (<a href="http://keenthemes.com/preview/metronic/theme/admin_4/ui_icons.html">Výběr barev zde</a>) </label>
                        <input type="text" class="form-control" id="editGeneralTariffLabelModal_icon"  name="icon">

                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default pull-left" type="button" data-dismiss="modal" onclick="$('#editGeneralTariffLabelModal').css('display','none')">Close</button>
                    <button id="editGeneralTariffLabelButton" value="" class="btn btn-primary" type="button" onclick="editGeneralTariffLabel()">Edit Label</button>
                </div>
            </div>
        </div>
    </div>

    <div id="newGeneralTariffExtensionModal" style="display: none;" class="modal">
        <div style="" class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Create New Extension</h4>
                </div>
                <div class="modal-body">
                    <form id="newGeneralTariffExtensionForm">

                        <label style="">Tariff Id:</label>
                        <input type="text" class="form-control" id="newGeneralTariffExtensionModal_id" name="id" readonly>

                        <label style="">Name:</label>
                        <input type="text" class="form-control" id="createGeneralTariffExtensionModal_name"  name="name">

                        <label ass="control-label">Description:</label>
                        <input type="text" class="form-control" id="createGeneralTariffExtensionModal_descritpion"  name="description">

                        <label class="control-label">Color:</label>
                        <input type="text" class="form-control" id="createtGeneralTariffExtensionModal_color"  name="color">



                        <label class="control-label">Price in CZK:</label>
                        <input type="text" class="form-control" id="czk"  name="czk">

                        <label class="control-label">Price in EUR:</label>
                        <input type="text" class="form-control" id="eur"  name="eur">

                        <label class="control-label">Price in USD:</label>
                        <input type="text" class="form-control" id="usd"  name="usd">


                    </form>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-default pull-left" type="button" data-dismiss="modal" onclick="$('#newGeneralTariffExtensionModal').css('display','none')">Close</button>
                    <button id="newGeneralTariffExtensionButton" value="" class="btn btn-primary" type="button" onclick="newGeneralTariffExtension()">Create New Label</button>
                </div>
            </div>
        </div>
    </div>

    <div id="editGeneralTariffExtensionModal" style="display: none;" class="modal">
        <div style="" class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Edit Extension</h4>
                </div>
                <div class="modal-body">
                    <form id="editGeneralTariffExtensionForm">

                        <label style="">Extension Id:</label>
                        <input type="text" class="form-control" id="editGeneralTariffExtensionModal_id"  name="id" readonly>

                        <label style="">Name:</label>
                        <input type="text" class="form-control" id="editGeneralTariffExtensionModal_name"  name="name">

                        <label ass="control-label">Description:</label>
                        <input type="text" class="form-control" id="editGeneralTariffExtensionModal_descritpion"  name="description">

                        <label class="control-label">Color:</label>
                        <input type="text" class="form-control" id="editGeneralTariffExtensionModal_color"  name="color">

                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default pull-left" type="button" data-dismiss="modal" onclick="$('#editGeneralTariffExtensionModal').css('display','none')">Close</button>
                    <button id="editGeneralTariffExtensionButton" value="" class="btn btn-primary" type="button" onclick="editGeneralTariffExtension()">Edit Extension</button>
                </div>
            </div>
        </div>
    </div>

@*/*/*  ----------------------------------------------------------------------------------------   */*/*@


<script>

    function openNewGeneralTariffLabelModal(tariff_id) {
        $("#newGeneralTariffLabelModal").css("display", "block");
        $('#newGeneralTariffLabelModal_id').val(tariff_id);
    }

    function openEditGeneralTariffLabelModal(id, label, description, icon) {
        $("#editGeneralTariffLabelModal").css("display", "block");

        $('#editGeneralTariffLabelModal_id').val(id);
        $('#editGeneralTariffLabelModal_label').val(label);
        $('#editGeneralTariffLabelModal_description').val(description);
        $('#editGeneralTariffLabelModal_icon').val(icon);
    }

    function updateGeneralTariff(){
        model_data = $("#tariff_main_form").serializeObject();
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_edit()',
            type: 'PUT',
            contentType: 'application/json',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken"),
                "Content-Type":"application/json"
            },
            data: JSON.stringify(model_data),
            dataType: 'json',
            success:function(data){

                BootstrapDialog.show({
                    type: BootstrapDialog.TYPE_SUCCESS,
                    buttons: [{
                        label: 'Close',
                        action: function(dialogItself) {
                            dialogItself.close();
                        }
                    }]

                });

            },
            error:function(data) {
                BootstrapDialog.show({
                    message: syntaxHighlight(data),
                    type: BootstrapDialog.TYPE_DANGER,
                    buttons: [{
                        label: 'Close',
                        action: function(dialogItself) {
                            dialogItself.close();
                        }
                    }]

                });
            }
        })
    }

    // Labels

    function newGeneralTariffLabel(){
        model_data = $("#newGeneralTariffLabelForm").serializeObject();
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_label_tariff_create()',
            type: 'POST',
            contentType: 'application/json',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken"),
                "Content-Type":"application/json"
            },
            data: JSON.stringify(model_data),
            dataType: 'json',
            success:function(e){
                $("#newGeneralTariffLabelForm input[type=text]").val("");
                $("#newGeneralTariffLabelModal").css("display","none");
                $('#allGeneralsTariffsLabel').load(document.URL +  ' #allGeneralsTariffsLabel');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
    })
    }

    function editGeneralTariffLabel(){
        model_data = $("#editGeneralTariffLabelForm").serializeObject();

        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_label_edit()',
            type: 'PUT',
            contentType: 'application/json',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken"),
                "Content-Type":"application/json"
            },
            data: JSON.stringify(model_data),
            dataType: 'json',
            success:function(e){
                $("#editGeneralTariffLabelModal").css("display","none");
                $('#allGeneralsTariffsLabel').load(document.URL +  ' #allGeneralsTariffsLabel');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }

    function removeGeneralTariffLabel(id){
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_label_remove("")' + id,
            type: 'DELETE',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsLabel').load(document.URL +  ' #allGeneralsTariffsLabel');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }

    function upGeneralTariffLabel(id){
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_label_edit_up("")' + id,
            type: 'PUT',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsLabel').load(document.URL +  ' #allGeneralsTariffsLabel');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }

    function downGeneralTariffLabel(id){
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_label_edit_down("")' + id,
            type: 'PUT',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsLabel').load(document.URL +  ' #allGeneralsTariffsLabel');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }


    // Extensions


    function openNewGeneralTariffExtensionModal(tariff_id) {
        $("#newGeneralTariffExtensionModal").css("display", "block");
        $('#newGeneralTariffExtensionModal_id').val(tariff_id);
    }

    function newGeneralTariffExtension(){
        model_data = $("#newGeneralTariffExtensionForm").serializeObject();
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_extension_create()',
            type: 'POST',
            contentType: 'application/json',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken"),
                "Content-Type":"application/json"
            },
            data: JSON.stringify(model_data),
            dataType: 'json',
            success:function(e){
                $("#newGeneralTariffExtensionForm input[type=text]").val("");
                $("#newGeneralTariffExtensionModal").css("display","none");
                $('#allGeneralsTariffsExtensions').load(document.URL +  ' #allGeneralsTariffsExtensions');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }



    function upGeneralTariffExtension(id){
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_extension_edit_up("")' + id,
            type: 'PUT',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsExtensions').load(document.URL +  ' #allGeneralsTariffsExtensions');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }

    function downGeneralTariffExtension(id){
        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_extension_edit_down("")' + id,
            type: 'PUT',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsExtensions').load(document.URL +  ' #allGeneralsTariffsExtensions');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }

    function deactivateGeneralTariffExtension(id){

        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_extension_deactivate("")' + id,
            type: 'PUT',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsExtensions').load(document.URL +  ' #allGeneralsTariffsExtensions');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }

    function activateGeneralTariffExtension(id){

        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_extension_activate("")' + id,
            type: 'PUT',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsExtensions').load(document.URL +  ' #allGeneralsTariffsExtensions');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }

    function deleteGeneralTariffExtension(id){

        $.ajax({
            url: '@routes.Controller_Finance.tariff_general_extension_delete("")' + id,
            type: 'DELETE',
            headers: {
                "X-AUTH-TOKEN":getCookie("authToken")
            },
            success:function(e){
                $('#allGeneralsTariffsExtensions').load(document.URL +  ' #allGeneralsTariffsExtensions');
            },
            error:function(e) {
                alert("Unsuccessful.");
            }
        })
    }


</script>
